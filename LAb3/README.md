# Lab 3: OpenSSL Heartbleed Exploitation (CVE-2014-0160)

## üìå Overview
This laboratory exercise demonstrates the practical exploitation of the Heartbleed vulnerability. By leveraging a flaw in the OpenSSL TLS/DTLS heartbeat extension (Buffer Over-read), this lab proves how an attacker can extract volatile, active memory (RAM) from a vulnerable server, exposing highly sensitive data such as session cookies and credentials.

## üõ†Ô∏è Infrastructure & Environment
- **Attacker Machine:** Parrot OS Security Edition
- **Target Machine:** SEED Labs Ubuntu 12.04 (IP: `192.168.122.159`)
- **Target Application:** Vulnerable Apache Web Server running an Elgg social network instance.
- **Hypervisor:** QEMU/KVM via Virt-Manager

> **‚öôÔ∏è Infrastructure Troubleshooting:** > Deploying legacy infrastructure (Ubuntu 12.04) on modern KVM virtualized hardware required manual intervention. The default `VirtIO` storage and network controllers caused boot failures (`initramfs` drop) and missing network interfaces (`eth0`). To establish the target environment, the virtual hardware was manually reconfigured to utilize legacy interfaces, specifically a **SATA Disk Bus** and an **e1000 Network Interface Card**.

## üõ°Ô∏è Technical Implementation

### Phase 1: Vulnerability Scanning (Reconnaissance)
Before launching the exploit, I verified the presence of the CVE-2014-0160 vulnerability using the Nmap scripting engine:
```bash
nmap -p 443 --script ssl-heartbleed 192.168.122.159

```

*The server responded to malformed heartbeat requests, confirming a "VULNERABLE" high-risk state.*

### Phase 2: Exploitation & Exfiltration

Using the Metasploit Framework, the `auxiliary/scanner/ssl/openssl_heartbleed` module was configured to target the SEED VM with verbose mode enabled to dump raw hexadecimal and ASCII memory.

To simulate a real-world attack, benign HTTP traffic was generated by logging into the web application via Firefox. Because the Heartbleed exploit only captures `64KB` of memory per request, the exploit was fired concurrently and repeatedly until active user session data was successfully captured from the server's RAM.

## üìä Evidence of Exploitation

<p align="center">
<img src="https://github.com/user-attachments/assets/eec41c40-cfa2-4939-9dfc-5722667f5832" alt="Heartbleed Memory Dump" width="800">

<b>Figure 1: Metasploit memory dump successfully exfiltrating an active Session Cookie.</b>
</p>

### üö® Impact Analysis (Session Hijacking)

Capturing this session cookie (`Elgg=senr8...`) represents a complete compromise of a user account. An attacker can perform **Session Hijacking** by injecting this cookie into their own browser, bypassing the authentication mechanism entirely without needing to crack or capture the plaintext password.

## üîí Security Mitigation

To mitigate this vulnerability, system administrators must:

1. **Patch:** Upgrade the OpenSSL library to version `1.0.1g` or later.
2. **Revoke & Reissue:** Generate new SSL/TLS certificates, as private keys may have been compromised in previous memory leaks.
3. **Invalidate Sessions:** Terminate all currently active session cookies to prevent hijacked access.
